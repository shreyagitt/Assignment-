// Generated by CoffeeScript 1.6.2
(function() {
  var explore, removeBackReferences;

  explore = require("./explore");

  module.exports = function(root, options, cb) {
    var current, job, _ref;

    if (typeof options === 'function') {
      _ref = [{}, options], options = _ref[0], cb = _ref[1];
    }
    current = {};
    options.sort = true;
    job = explore(root, options);
    job.on("directory", function(root, name) {
      return current[name] = {
        "..": current
      };
    });
    job.on("enter", function(root, name) {
      return current = current[name];
    });
    job.on("leave", function(root, name) {
      return current = current[".."];
    });
    return job.on("end", function(error) {
      if (error) {
        return cb(error);
      }
      removeBackReferences(current);
      return cb(null, current);
    });
  };

  removeBackReferences = function(dir) {
    var name, subdir, _results;

    delete dir['..'];
    _results = [];
    for (name in dir) {
      subdir = dir[name];
      _results.push(removeBackReferences(subdir));
    }
    return _results;
  };

}).call(this);

/*
//@ sourceMappingURL=getNamespaceObject.map
*/
